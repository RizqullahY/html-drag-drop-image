<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paste & Drag Image</title>

<style>
:root {
    --bg: #f0f2f5;
    --card: #ffffff;
    --border: #007bff;
    --text: #222;
    --muted: #666;
    --btn: #007bff;
}

@media (prefers-color-scheme: dark) {
    :root {
        --bg: #0f1115;
        --card: #1c1f26;
        --border: #4da3ff;
        --text: #f1f1f1;
        --muted: #aaa;
        --btn: #4da3ff;
    }
}

body {
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 50px;
}

.container {
    border: 3px dashed var(--border);
    background: var(--card);
    border-radius: 15px;
    width: 420px;
    min-height: 260px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: 0.2s;
}

.container.dragover {
    border-color: #28a745;
    background: rgba(40,167,69,0.1);
}

.instruction {
    color: var(--muted);
}

#preview {
    max-width: 100%;
    max-height: 300px;
    margin-top: 15px;
    border-radius: 10px;
    display: none;
    cursor: grab;
    border: 1px solid #333;
}

#preview:active {
    cursor: grabbing;
}

button {
    margin-top: 15px;
    padding: 8px 18px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: var(--btn);
    color: #fff;
    display: none;
}

.status {
    margin-top: 10px;
    font-size: 14px;
    height: 20px;
}
</style>
</head>

<body>

<div class="container" id="dropZone">
    <div class="instruction">
        <p>1. <b>Paste (Ctrl+V)</b></p>
        <p>2. <b>Drag & Drop</b></p>
    </div>

    <img id="preview" draggable="true">
    <button id="copyBtn">Copy Ulang</button>
    <div id="status" class="status"></div>
</div>

<script>
const dropZone = document.getElementById('dropZone');
const preview  = document.getElementById('preview');
const status   = document.getElementById('status');
const copyBtn  = document.getElementById('copyBtn');

/* ===============================
   UTIL
================================ */
function showImage(src) {
    preview.src = src;
    preview.style.display = 'block';
    copyBtn.style.display = 'inline-block';
    status.textContent = "‚úÖ Gambar siap digunakan";
}

/* ===============================
   PASTE (CTRL+V)
================================ */
document.addEventListener('paste', e => {
    const items = e.clipboardData.items;
    for (const item of items) {
        if (item.kind === 'file' && item.type.startsWith('image/')) {
            const file = item.getAsFile();
            const reader = new FileReader();
            reader.onload = ev => showImage(ev.target.result);
            reader.readAsDataURL(file);
        }
    }
});

/* ===============================
   DRAG MASUK (DROP KE DALAM)
================================ */
dropZone.addEventListener('dragover', e => {
    e.preventDefault();
    dropZone.classList.add('dragover');
});

dropZone.addEventListener('dragleave', () => {
    dropZone.classList.remove('dragover');
});

dropZone.addEventListener('drop', e => {
    e.preventDefault();
    dropZone.classList.remove('dragover');

    const file = e.dataTransfer.files[0];
    if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => showImage(ev.target.result);
        reader.readAsDataURL(file);
    }
});

/* ===============================
   DRAG KELUAR (KE TAB / APP LAIN)
================================ */
preview.addEventListener('dragstart', e => {
    e.dataTransfer.setData('text/uri-list', preview.src);
    e.dataTransfer.setData('text/plain', preview.src);
    e.dataTransfer.setData(
        'DownloadURL',
        `image/png:image.png:${preview.src}`
    );
    status.textContent = "üöÄ Drag keluar gambar";
});

preview.addEventListener('dragend', () => {
    status.textContent = "‚úÖ Selesai";
});

/* ===============================
   COPY ULANG
================================ */
copyBtn.addEventListener('click', async () => {
    try {
        const blob = await (await fetch(preview.src)).blob();
        await navigator.clipboard.write([
            new ClipboardItem({ [blob.type]: blob })
        ]);
        status.textContent = "üìã Disalin ke clipboard";
    } catch {
        status.textContent = "‚ùå Gagal copy";
    }
});
</script>

</body>
</html>
